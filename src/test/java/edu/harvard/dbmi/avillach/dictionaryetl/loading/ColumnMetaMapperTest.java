package edu.harvard.dbmi.avillach.dictionaryetl.loading;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ContextConfiguration;

import java.util.List;
import java.util.Optional;

import static org.junit.jupiter.api.Assertions.*;

@SpringBootTest
@ContextConfiguration(classes = ColumnMetaMapper.class)
class ColumnMetaMapperTest {

    @Autowired
    private ColumnMetaMapper columnMetaMapper;

    @Test
    void mapCSVRowToColumnMeta() {
        List<String> listOfValues = List.of(
                "\\demographics\\AGE\\,8,0,false,,0.0,85.0,380670,761347,9999,9999",
                "\\laboratory\\acrylamide\\Acrylamide (pmoL per G Hb)\\,4,0,true," +
                "100µ101µ103µ104µ105µ106µ107µ108µ109µ110µ111µ112µ113µ114µ115µ116µ117µ118µ119µ120µ121µ122µ123µ124µ125µ126µ127µ128µ129µ130µ131µ132µ133µ134µ135µ136µ137µ138µ139µ140µ141µ142µ143µ145µ146µ147µ148µ149µ15.6µ151µ152µ153µ154µ155µ156µ158µ159µ16.1µ16.8µ160µ161µ163µ166µ167µ168µ169µ17.4µ171µ172µ173µ174µ175µ177µ178µ179µ18.7µ184µ186µ188µ193µ195µ196µ197µ198µ2µ20.1µ20.2µ20.3µ20.7µ20.9µ200µ205µ206µ208µ21.1µ21.2µ21.3µ21.4µ21.5µ21.7µ210µ211µ213µ214µ216µ22µ22.4µ22.7µ220µ222µ223µ225µ227µ23µ23.2µ23.3µ23.7µ230µ233µ235µ236µ238µ24.1µ24.3µ24.4µ24.7µ24.8µ242µ25µ25.1µ25.4µ25.5µ25.7µ250µ251µ253µ254µ255µ256µ258µ259µ26µ26.1µ26.2µ26.3µ26.4µ26.6µ26.7µ26.9µ261µ264µ27µ27.1µ27.2µ27.3µ27.4µ27.5µ27.6µ27.7µ27.8µ27.9µ272µ275µ276µ28µ28.1µ28.2µ28.3µ28.4µ28.7µ28.8µ28.9µ285µ289µ29µ29.1µ29.2µ29.3µ29.4µ29.6µ29.8µ29.9µ293µ295µ30µ30.1µ30.2µ30.3µ30.4µ30.5µ30.6µ30.7µ30.8µ30.9µ300µ308µ31µ31.1µ31.2µ31.3µ31.4µ31.6µ31.8µ311µ313µ318µ32µ32.1µ32.2µ32.3µ32.4µ32.5µ32.6µ32.7µ32.9µ328µ33.1µ33.2µ33.3µ33.4µ33.5µ33.6µ33.7µ33.9µ34.1µ34.2µ34.3µ34.5µ34.7µ34.8µ34.9µ347µ35µ35.1µ35.3µ35.4µ35.5µ35.6µ35.8µ35.9µ357µ36µ36.1µ36.4µ36.5µ36.6µ36.7µ36.8µ36.9µ37.1µ37.2µ37.3µ37.4µ37.5µ37.6µ37.7µ37.8µ37.9µ38µ38.1µ38.2µ38.3µ38.4µ38.5µ38.6µ38.7µ38.8µ38.9µ39µ39.1µ39.2µ39.3µ39.4µ39.5µ39.6µ39.7µ39.8µ39.9µ40µ40.1µ40.2µ40.3µ40.4µ40.5µ40.6µ40.7µ40.8µ40.9µ409µ41µ41.1µ41.2µ41.3µ41.4µ41.5µ41.6µ41.8µ42µ42.1µ42.2µ42.3µ42.4µ42.5µ42.6µ42.7µ42.8µ42.9µ43µ43.1µ43.2µ43.3µ43.4µ43.5µ43.6µ43.7µ43.8µ43.9µ44µ44.1µ44.2µ44.3µ44.4µ44.5µ44.6µ44.7µ44.8µ44.9µ447µ45µ45.1µ45.2µ45.3µ45.4µ45.5µ45.6µ45.7µ45.8µ45.9µ46µ46.1µ46.2µ46.3µ46.4µ46.5µ46.6µ46.7µ46.8µ46.9µ467µ47µ47.1µ47.2µ47.3µ47.4µ47.5µ47.6µ47.7µ47.8µ47.9µ48µ48.1µ48.2µ48.3µ48.4µ48.5µ48.6µ48.7µ48.8µ48.9µ49µ49.1µ49.2µ49.3µ49.4µ49.5µ49.6µ49.7µ49.8µ49.9µ50µ50.1µ50.2µ50.3µ50.5µ50.6µ50.7µ50.8µ50.9µ502µ51µ51.1µ51.2µ51.3µ51.4µ51.5µ51.6µ51.7µ51.8µ51.9µ513µ52µ52.1µ52.2µ52.3µ52.4µ52.5µ52.6µ52.7µ52.8µ52.9µ53µ53.1µ53.2µ53.3µ53.4µ53.5µ53.6µ53.7µ53.9µ54µ54.1µ54.2µ54.3µ54.4µ54.5µ54.6µ54.7µ54.8µ54.9µ55.1µ55.2µ55.3µ55.4µ55.7µ55.8µ55.9µ56µ56.1µ56.2µ56.3µ56.4µ56.5µ56.7µ56.8µ56.9µ57µ57.1µ57.2µ57.3µ57.4µ57.5µ57.6µ57.7µ57.9µ58µ58.1µ58.2µ58.3µ58.4µ58.5µ58.6µ58.7µ58.8µ58.9µ59µ59.1µ59.3µ59.4µ59.5µ59.6µ59.7µ59.8µ59.9µ60µ60.1µ60.2µ60.3µ60.4µ60.5µ60.6µ60.7µ60.8µ60.9µ61µ61.1µ61.2µ61.3µ61.4µ61.5µ61.6µ61.7µ61.8µ62µ62.1µ62.2µ62.3µ62.4µ62.5µ62.6µ62.7µ62.8µ62.9µ63µ63.1µ63.2µ63.3µ63.4µ63.5µ63.6µ63.7µ63.8µ63.9µ64µ64.1µ64.3µ64.4µ64.5µ64.6µ64.7µ64.8µ64.9µ65µ65.1µ65.2µ65.3µ65.4µ65.5µ65.6µ65.7µ65.8µ66µ66.1µ66.2µ66.3µ66.5µ66.6µ66.7µ66.8µ66.9µ67µ67.1µ67.4µ67.7µ67.8µ67.9µ68µ68.1µ68.3µ68.4µ68.5µ68.6µ68.7µ68.9µ69µ69.1µ69.2µ69.5µ69.6µ69.8µ69.9µ70µ70.1µ70.2µ70.3µ70.4µ70.5µ70.8µ70.9µ71µ71.1µ71.2µ71.3µ71.5µ71.6µ71.7µ71.8µ71.9µ72µ72.1µ72.2µ72.3µ72.4µ72.5µ72.6µ73.1µ73.2µ73.3µ73.5µ73.7µ73.8µ73.9µ74µ74.1µ74.3µ74.4µ74.5µ74.6µ74.8µ74.9µ75µ75.1µ75.2µ75.3µ75.9µ76.3µ76.4µ76.5µ76.6µ76.8µ77.1µ77.2µ77.4µ77.5µ77.6µ77.7µ77.8µ77.9µ78µ78.3µ78.4µ78.6µ78.7µ78.9µ79µ79.1µ79.3µ79.4µ79.8µ80µ80.1µ80.2µ80.3µ80.4µ80.5µ80.9µ81µ81.1µ81.2µ81.6µ81.7µ81.8µ82µ82.2µ82.4µ82.6µ82.8µ82.9µ83.2µ83.3µ83.6µ83.7µ83.9µ84.4µ84.6µ84.7µ84.8µ84.9µ85.1µ85.3µ85.4µ85.6µ85.8µ85.9µ86µ86.4µ86.5µ86.6µ86.7µ86.8µ87.1µ87.2µ87.6µ87.8µ88µ88.2µ88.4µ88.5µ88.8µ89.3µ89.5µ89.6µ89.7µ90µ90.2µ90.3µ90.4µ90.5µ90.7µ90.8µ90.9µ91.4µ91.9µ92.4µ92.6µ92.8µ93µ93.2µ93.7µ94.1µ94.2µ94.9µ95.3µ95.4µ95.9µ96.4µ96.6µ97.1µ97.2µ97.4µ97.5µ97.7µ97.8µ97.9µ98.1µ98.7µ98.8µ99µ99.1µ99.3,null,null,11982909,12066159,1688,1688",
                "\\examination\\physical fitness\\Recovery 2 diastolic BP (mm Hg)\\,8,0,false,,39.0,129.0,11282485,11365210,2157,2157",
                "\\demographics\\RACE\\other_hispanic\\,14,0,true,other_hispanic,null,null,1988040,2012079,454,454"
        );

        List<Optional<ColumnMeta>> list = listOfValues.stream().map(columnMetaMapper::mapCSVRowToColumnMeta).toList();
        assertFalse(list.isEmpty());
        assertTrue(list.get(3).isPresent());
        assertEquals(4, list.size());
        assertEquals("\\demographics\\RACE\\", list.get(3).get().name());
        System.out.println(list);
    }
}